<#Module=mdlDemo>
'---------------------------------------
Sub Load(cmdLine)
  With form
  
  .width = 3000
  .caption = "Работа с системным треем!"
  .nomovemouse = true

  .add "command",1, ".move 800,500,1500,400", ".caption=""Анимация"""
  .add "command",2, ".move 800,1000,1500,400", ".caption=""Пауза"""
  .add "command",3, ".move 800,1500,1500,400", ".caption=""Стоп"""

  Set .tray.trayicon = ResToPic("1")
  .tray.traytip = "Tray work!"
  .tray.timer.interval = 100

  for a = 100 to 107
     .tray.anim.add ResToPic(a)
  next

  .tray.intray = true

  .menu.popup = true
  .menu.add 1, "New"
  .menu.add 2, "Open"
  .menu.add 3, "Save"
  .menu.add 4, "Save as"
  .menu.add 5, "-"
  .menu.add 6, "Page Setup"
  .menu.add 7, "Print"
  .menu.add 8, "-"
  .menu.add 9, "Exit"

  .center
  .show
  
  End With
End Sub
<#Module>

<#Form=form>
'---------------------------------------
Sub Command1_Click
  this.tray.trayplay
End Sub

'---------------------------------------
Sub Command2_Click
  this.tray.timer.enabled =  not this.tray.timer.enabled
End Sub

'---------------------------------------
Sub Command3_Click
  this.tray.traystop
End Sub

'---------------------------------------
Sub Tray_MouseDown(button)
  msgbox "Вы нажали кнопку - " + cstr(button)
  this.menu.show
End Sub

'---------------------------------
Sub Menu_Click(id)
 if id<>9 then
   msgbox this.menu.text(id)
 else
   endmf
 end if
End Sub


'---------------------------------------
Sub Form_Unload
  endmf
End Sub
<#Form>


<#res id="100" mode=base64 #>
AAABAAEAICAIAAAAAADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAEAAA
AAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAwMDAAICAgAAAAP8AAP8AAAD//wD/AAAA
/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREREQAAAAAAAAAAAAABEJEREREREAA
AAAAAAAABEQiJEREREREQAAAAAAAAEREIiREREREREQAAAAAAIRERCIiREREREREQAAAAAhEREQi
IiREREREREIAAACEREREIiIiREREREQiIAAAhERERCKiIiREREREIiAACERETEQqKiIkREREQiIi
AAhERETEIqKiIkREREIiIgAIRETEQioqKiLERERCIiIAhERMTMKioqKiJMREQiIiIIRMRMRCqioq
IkREIkIiIiCMRMTCKqqiIsxEwqIiIiIghExMKnd6oszEzCoqKiIiIIzEwqciJ3LMzMQqoqKiIiCE
zCpyzMIszMxMKioqIiIgjMwnLMzMzMzMxCKioqIiQIzCeizMLMzMzMxEKioiIiAIwqoiIizMzMzE
zEIiREQACCqqqqoszMzMzEREREREAAL6p6qqoizMzMxExCJEIgAAJ/r6qqqizEzEzEJ6QiAAAC+v
r6qqoszMTMRCoiIgAAAC+void3LExMRExCoiAAAAAC+vLCIkwizMxEQnIAAAAAAC+izMzMKiJERE
IiAAAAAAAC8szMRCeiREREIAAAAAAAACjMxMJ3oiREiAAAAAAAAAAAiIzEIiJIiAAAAAAAAAAAAA
AIiIiIgAAAAAAAD///////AP//+AAf/+AAB//AAAP/AAAB/gAAAPwAAAB8AAAAeAAAADgAAAA4AA
AAMAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAYAAAAOAAAADgAAAA8AAAAfAAAAH4AAA
D/AAAB/4AAAf/AAAP/4AAH//gAH///AP/w==
<#res#>


<#res id="101" mode=base64 #>
AAABAAEAICAIAAAAAADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAEAAA
AAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAwMDAAICAgAAAAP8AAP8AAAD//wD/AAAA
/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREREQAAAAAAAAAAAAABERERERCREAA
AAAAAAAABEREREREIiREQAAAAAAAAERERERERCIkREQAAAAAAIREREREREQiIkREQAAAAAhERERE
REREIiIkREQAAACERERERERERCIiIkREQAAAhEREREREREQiIiIkREAACERETETExExEIiIiJERE
AAhERETETERERCKiIiJERAAIRETETETExMIqKiIiREQAhERMTMTMTExCoqKiIiREQIRMRMRMxMxM
QioqKiJERCCMRMTMxMzMwiqioiJEREIghExMTEzMzCoqKiJEREQiIIzExMzMzMKiIiKiTEREIiCE
zMTEzMwnosxCJERERCcgjMzMzMzMJyzMxMxMREQiIIzMzEzMwnoszCxExERERCAIzMzMzMJ6IiIk
zETEREQACMzMzMwnqqKiLEREREREAAjMzMzCeqqqKiIkxERERAAAjMzMwnqqqqKiIkxEREAAAIzM
zCeqqqoqKiJERERAAAAILMJ6qqqqIqIixEREAAAAACInqqqqqiwiJEIkQAAAAAAC/6eqqqokxERC
IiAAAAAAACL3enpyLEREQnIAAAAAAAACIiKiIiRERCIgAAAAAAAAAAiILELERIiAAAAAAAAAAAAA
AIiIiIgAAAAAAAD///////AP//+AAf/+AAB//AAAP/AAAB/gAAAPwAAAB8AAAAeAAAADgAAAA4AA
AAMAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAYAAAAOAAAADgAAAA8AAAAfAAAAH4AAA
D/AAAB/4AAAf/AAAP/4AAH//gAH///AP/w==
<#res#>


<#res id="102" mode=base64 #>
AAABAAEAICAIAAAAAADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAEAAA
AAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAwMDAAICAgAAAAP8AAP8AAAD//wD/AAAA
/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREREQAAAAAAAAAAAAABEREREREREAA
AAAAAAAABEREREREREREQAAAAAAAAEREREREREREREQAAAAAAIREREREREREREREIAAAAAJERERE
RERERERERCIAAAAiREREREREREREREQiIAAAIkREREREREREREREIiAAAiRETETExExERERERCIi
AAIkRETETEREREREREQiIgACJETETETExMTERERCIiIAgkRMTMTMTExMRMREQiIiIIRMRMRMxMxM
REREREIiIiCMRMTMxMzMzMxExMIiIiIghExMTEzMzMzEzEQqIiIiQIzExMzMzMzMzMRCoiIiIkCE
zMTEzMzMzMxMKiJEQiRAjMzMzMzMzMzMxCIsREREQIzMzEzMzMzMzMIqJEQkREAIzMzMzMzMzMzC
ciIiJEQACMzMzMzMzMzMJ6oiIiREAAjMzMzMzMzMwnqioiIiJAAAjMzMzMzMzEJ6qioiIiAAAIzM
zMzMzMwnqqKiIiIgAAAILMzMwizCeqoqIiIiAAAAAIIszCpyJ6qioqIkIAAAAAACoswnqqqqKioi
JIAAAAAAACLMKndyoqKiIigAAAAAAAAIjMIiJCIiIiIgAAAAAAAAAAiIzEzERIiAAAAAAAAAAAAA
AIiIiIgAAAAAAAD///////AP//+AAf/+AAB//AAAP/AAAB/gAAAPwAAAB8AAAAeAAAADgAAAA4AA
AAMAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAYAAAAOAAAADgAAAA8AAAAfAAAAH4AAA
D/AAAB/4AAAf/AAAP/4AAH//gAH///AP/w==
<#res#>


<#res id="103" mode=base64 #>
AAABAAEAICAIAAAAAADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAEAAA
AAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAwMDAAICAgAAAAP8AAP8AAAD//wD/AAAA
/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREREQAAAAAAAAAAAAABEREREREREAA
AAAAAAAABEREREREREREQAAAAAAAAEREREREREREREQAAAAAAIREIiREREREREREQAAAAAgiIiIi
REREREREREQAAACCIiIiIkREREREREREQAAAgiIiIiJEREREREREREAACEQnKiokxExERERERERE
AAhEQqKnLERERERERERERAAIREQneiTExMTEREREREQAhERMQsLMTExMRMREREREQIRExMRMxMxM
RERERERERECMTETMxMzMzMxExMRERERAgkxMTEzMzMzEzEREREREIILExMzMzMzMzMRETEREQiCC
LMzEzMzMzMxMxERERCIgIqLMzMzMzMzMxMxMREQiIC+qLEzMzMzMzMxExERCIiAC+izMzMzMzMzE
zETEQiIAAvoszMzMzMzMzERERCIiAAL6oizMzMzMzMxExEIiIgAAL/oizMzMzEzEzExCIiAAAC+v
oiLMzMzMTMREIiIgAAAC+vosxCzExMIkwiIiAAAAAC+voiJyLMwiIiIiIAAAAAAC/6qqqiLEKiIi
IiAAAAAAACIiIiIiTCJyIiIAAAAAAAAIjMxMxERCIiggAAAAAAAAAAiIzEzERIiAAAAAAAAAAAAA
AIiIiIgAAAAAAAD///////AP//+AAf/+AAB//AAAP/AAAB/gAAAPwAAAB8AAAAeAAAADgAAAA4AA
AAMAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAYAAAAOAAAADgAAAA8AAAAfAAAAH4AAA
D/AAAB/4AAAf/AAAP/4AAH//gAH///AP/w==
<#res#>


<#res id="104" mode=base64 #>
AAABAAEAICAIAAAAAADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAEAAA
AAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAwMDAAICAgAAAAP8AAP8AAAD//wD/AAAA
/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREREQAAAAAAAAAAAAABEREREREREAA
AAAAAAAABEREREREREREQAAAAAAAAEREREREREREREQAAAAAAIRERERERCIkREREQAAAAAhERERE
IiIiIkREREQAAACEREREQioiIiJEREREQAAAhEREREKioqIiREREREAAAiRETETEKioqJERERERE
AAhERETETEKqoiRERERERAAIRETETETEJ6okREREREQAhERMTMTMTEJCRMREREREQCRMRMRMzMxM
REREREREREAiRMTMxMzMzMxExMRERERAJExCTELMzMzEzEREREREQIzEwizCzMzMzMRETERERECE
zCoiwizMzMxMxERERERAgswqoiIizMzMxMxMREREQCIiqqqioizMzMxExEREREAC+qqqqioszMzE
zETEREQAAvqqqqqiLMzMzEREREREAAL/r6qqqqIszMxExERERAAAL/p6qqqqIkzEzExEREAAAC+v
r6qqqqIiTMRERERAAAAC+vp6qqqqJMQkxERCAAAAAC+vr6qqqqIiIiREIAAAAAAC+vp6qqqqKioi
RCAAAAAAAC+vqiIiIiIiIkgAAAAAAAACKvosxEREREiAAAAAAAAAAAIizEzERIiAAAAAAAAAAAAA
AIiIiIgAAAAAAAD///////AP//+AAf/+AAB//AAAP/AAAB/gAAAPwAAAB8AAAAeAAAADgAAAA4AA
AAMAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAYAAAAOAAAADgAAAA8AAAAfAAAAH4AAA
D/AAAB/4AAAf/AAAP/4AAH//gAH///AP/w==
<#res#>


<#res id="105" mode=base64 #>
AAABAAEAICAIAAAAAADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAEAAA
AAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAwMDAAICAgAAAAP8AAP8AAAD//wD/AAAA
/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREREQAAAAAAAAAAAAABEREREREREAA
AAAAAAAABEREREREREREQAAAAAAAAEREREREREREREQAAAAAAIREREREREREREQiIAAAAAIkRERE
RERERCIiIiIAAAAiIkREREREREIiIiIiQAAAIiIkRERERERCoiIiIkAAAioiIkRExExERCoiIiRE
AAKioiLETERERERCoiIkRAACKioiTETExMTERCoiJEQAgqKiIsTMTExMRMRCQkREQCIqKiIsxMxM
RMREREREREAioqqiIszMzMxMRMRERERAJyqqqizMwszCzMxEREREQCeqqqLMzMIswsRMTEREREAn
qqokLMwiIsIsxMRERERAJ6qiwqLMKqIiIsxEREREQCoiIieqIqqqKiIkxEREREACzMwnqqqqqqKi
LEREREQACMzMKqqqqqqqKiREREREAAjMInqqqqqqoqIiJERERAAAgnqqqqqqqqoqIiJEREAAAC+v
r6qqqqqioiIiIkRAAAAC+vr6qqqqqioiIiREAAAAAC+vqqqqqqKiIiIiIAAAAAAC//d6qqoqKiIi
IiAAAAAAACIiJ6eioqIiIiIAAAAAAAAIjMIiIiIiJEiAAAAAAAAAAAiIzEwiIiiAAAAAAAAAAAAA
AIiIiIgAAAAAAAD///////AP//+AAf/+AAB//AAAP/AAAB/gAAAPwAAAB8AAAAeAAAADgAAAA4AA
AAMAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAYAAAAOAAAADgAAAA8AAAAfAAAAH4AAA
D/AAAB/4AAAf/AAAP/4AAH//gAH///AP/w==
<#res#>


<#res id="106" mode=base64 #>
AAABAAEAICAIAAAAAADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAEAAA
AAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAwMDAAICAgAAAAP8AAP8AAAD//wD/AAAA
/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREREQAAAAAAAAAAAAABEREREREREAA
AAAAAAAABEREREREREREQAAAAAAAAEREREREREREREQAAAAAAIREREREREREREREQAAAAAhERERC
JEREREREREQAAACEREREIiJERERERERCIAAAhERERCIiJEREREREQiAACERETEIqIiJEREREREQi
AAhERETCoqIiREREREREQgACRETEQioqIsTEREREREQAIiRMTMKioiJMRMREREREQCJMRCJCKioi
JERERERERECMRMIiIqKioiJExMRERERAhEwiqqqqKiokzEJEQkREQIzEKqqqqqKizMRCLEJERECE
zCeqqqqqLCxMIiJCJERAjMwneqp3csKixCIiIiJEQIzMwid3IiIqqiIqIiIiJEAIzMzCIszMKqqq
oqIiIiQACMzMzMzMzCqqqqoqIiIkAAjMzMwizCIqqqqioiIiIgAAjMzCesKqqqqqqioiIiAAAIzM
wnoqqqqqqqKiIiIgAAAIzMwnqqqqqqoqKiIiAAAAAIzMJ6qqqqqioqIiIAAAAAAIzCd6qqqqKioi
IiAAAAAAAIzCJ3dyIiIiIiIAAAAAAAAIjMIiJERCIiIgAAAAAAAAAAiIzEzERIiAAAAAAAAAAAAA
AIiIiIgAAAAAAAD///////AP//+AAf/+AAB//AAAP/AAAB/gAAAPwAAAB8AAAAeAAAADgAAAA4AA
AAMAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAYAAAAOAAAADgAAAA8AAAAfAAAAH4AAA
D/AAAB/4AAAf/AAAP/4AAH//gAH///AP/w==
<#res#>


<#res id="107" mode=base64 #>
AAABAAEAICAIAAAAAADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAEAAA
AAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAwMDAAICAgAAAAP8AAP8AAAD//wD/AAAA
/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREREQAAAAAAAAAAAAABEREREREREAA
AAAAAAAABEREREREREREQAAAAAAAAEREREREREREREQAAAAAACJEREREREREREREQAAAAAIiJERE
REREQiREREQAAAAiIiJERERERCIiREREQAAAIiIiJEREREQiIiREREAAAiIiKiTExExCIiIiRERE
AAIioqKiTEREQqIiIkRERAACKioqIkTExMIqIiJEREQAIqKiqqIsTExCoqIiREREQCIqKqoixMwi
QioqIiREREAioqqixMzCoiKioiIiRERAKiqiTEzMKioqKioiJERCQCIqoszMzCqqqqKiIkREQiCE
wiTEzMwqqqqqKiQkRCIgjMzMzMzMJ6qqoqJCIkQiIIwszEzMzMIqqiIiIiIiIiACLMzMzMzMwiLE
zCIiIiIAAizMzMzMzMzMzEQqIiIiAALyLMzMzMzMIswiIqIiIgAAKqLMzMzMwqrCqioiIiAAAC+i
zMzMzMJ6qqKioiIgAAAC8szMxMzEKqqqKiIiAAAAACzCLMzEzCqqoqIiIAAAAAAIwqIszMQnqioi
IiAAAAAAACL6LMRMQiKiIiIAAAAAAAACLyJMxERCIiIgAAAAAAAAAAIizEzERIiAAAAAAAAAAAAA
AIiIiIgAAAAAAAD///////AP//+AAf/+AAB//AAAP/AAAB/gAAAPwAAAB8AAAAeAAAADgAAAA4AA
AAMAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAYAAAAOAAAADgAAAA8AAAAfAAAAH4AAA
D/AAAB/4AAAf/AAAP/4AAH//gAH///AP/w==
<#res#>


<#res id="1" mode=base64 #>
AAABAAEAEBAAAAEACABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAQAEAAAAAAAAAAAAAAAAA
AAAAAAAAAAAA8PDwAPDv8ADv7+8AUE/vAE9P7wDu7u4AiIbuAGDq6gBgyOoAYKXqAGCD6gDqYOoA
yGDqAKVg6gCDYOoAZGHpAND55AA65OQA+dDkADq65AA6j+QAOmXkAOQ65AC6OuQAjzrkAGU65ABA
POMAqvTiAPSq4gDg4OAAQEDgAD8/4ADf398APz/fADA/3wAwMN8A0PnbAPnQ2wAe19cAHqnXAB56
1wAeTdcA1x7XAKke1wB6HtcATR7XANbW1gAjH9YAhe/VAO+F1QD5+dAA7/nQAOT50ADb+dAA0PnQ
APnv0AD55NAA+dvQAPnQ0AAvL9AALyDQAKr0zwDPz88A9KrPACAgzwAgH88AHx/PAGDqyADqYMgA
EBDAAA8AvwAAAL8Avr6+AKr0vQD0qr0Ahe+6ADrkugDvhboA5Dq6ABixsQAYi7EAGGWxALEYsQCL
GLEAZRixAD8YsQAaQLAAHhqwAPT0qgDi9KoAz/SqAL30qgCq9KoA9OKqAPTPqgD0vaoA9KqqAB7X
qQDXHqkAp6enAGDqpQDqYKUA8MikAKSgoACF758A74WfADrkjwD/0I8Aj4+PAOQ6jwATjIwAE2+M
ABNQjACME4wAbxOMAFATjAAyE4wAGLGLABQyiwCxGIsAFxSLAO/vhQDV74UAuu+FAJ/vhQCF74UA
79WFAO+6hQDvn4UA74WFAGDqgwDqYIMA/89/AB7XegDXHnoAd3d3AP/PcAD/wG8AE4xvAIwTbwBu
bm4ADmdnAA5RZwBnDmcAUQ5nADoOZwAPJWYAOuRlABixZQDkOmUAsRhlAGNjYwDq6mAAyOpgAKXq
YACD6mAAYOpgAOrIYAD/wGAA6qVgAOqDYADqYGAA/8BfAF9fXwBYWFgADmdRAGcOUQD/v1AA8L9Q
ABOMUACME1AA8L9PAB7XTQBNTU0A1x5NAEdHRwBCQkIAGLE/APCwPwA/Pz8AAD8/ALEYPwA/AD8A
AAA/AOTkOgC65DoAj+Q6AGXkOgA65DoA5Lo6AOSPOgAOZzoA5GU6AOQ6OgBnDjoANzc3ABOMMgCM
EzIA8LAwADAwMADwry8ALCwsAA5nJAAhISEA8K8gANfXHgCp1x4AetceAE3XHgDXqR4A13oeANdN
HgDXHh4AsbEYAIuxGABlsRgAP7EYALGLGACxZRgAsT8YALEYGACMjBMAb4wTAFCMEwATjBMAjG8T
AIxQEwCMMhMA76AQAO+gDwAPDw8AZ2cOAFFnDgAkZw4AZ1EOAGc6DgBnJA4A//8AAAD/AAC/fwAA
kGAAAD8/AAAAPwAA/wAAAD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/
//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAA5+fn5+cAAAAAAAAAAADn5x4eISEh5+cAAAAAAADnAx5s
ioqKbCEh5wAAAADnA2yzx8nN5eaKbCHnAAAA5wKorLPw8fDl5ooh5wAA5wFso6ms/z/xzeXmbCHn
AOcBip+jqP8h8cnN5Yoh5wDn/4qJn6P///HHyc2KHucA5/+KhYmfo6iss8fJih7nAOf/bIWFifDx
8Kyzx2we5wAA5/+KhYX///GorIoD5wAAAOf/bIqFhYmfo4psA+cAAAAA5///bIqKimwBAecAAAAA
AADn5///////5+cAAAAAAAAAAADn5+fn5wAAAAAAAP//AAD4PwAA4A8AAMAHAACAAwAAgAMAAAAB
AAAAAQAAAAEAAAABAAAAAQAAgAMAAIADAADABwAA4A8AAPg/AAA=
<#res#>
